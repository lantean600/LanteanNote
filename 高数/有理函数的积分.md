---
layout: default
title: "有理函数的积分"
mathjax: true
---

有理函数是指两个多项式的商，形式为：
$$\frac{P(x)}{Q(x)} = \frac{a_0 x^n + a_1 x^{n-1} + \cdots + a_n}{b_0 x^m + b_1 x^{m-1} + \cdots + b_m}$$

真分式与假分式

· 当分子次数 $n$ 小于分母次数 $m$ 时，称为真分式。
· 当 $n \geq m$ 时，称为假分式。

部分分式分解
在实数范围内，任意多项式$Q(x)$ 总可以分解为一次因式和二次不可约因式的乘积：
$$Q(x) = (x - a)^k \cdots (x^2 + px + q)^r$$


对于真分式 $\frac{P(x)}{Q(x)}$ ，其部分分式分解形式为

$$
\frac{P(x)}{Q(x)} = \sum_{i=1}^k \left( \frac{A_{i1}}{(x - a_i)} + \frac{A_{i2}}{(x - a_i)^2} + \cdots + \frac{A_{ik_i}}{(x - a_i)^{k_i}} \right) + \sum_{j=1}^r \left( \frac{M_{j1}x + N_{j1}}{x^2 + p_j x + q_j} + \cdots + \frac{M_{jr_j}x + N_{jr_j}}{(x^2 + p_j x + q_j)^{r_j}} \right)
$$

示例：部分分式分解
考虑分式 $\frac{x + s}{(x - 1)(x + 2)}$ :

$$
\frac{x + s}{(x - 1)(x + 2)} = \frac{A}{x - 1} + \frac{B}{x + 2}
$$

$$
x + s = A(x + 2) + B(x - 1) = (A + B)x + (2A - B)
$$

$$
\begin{cases}
A + B = 1 \\
2A - B = s
\end{cases}
\quad \Rightarrow \quad
A = \frac{s + 1}{3}, \quad B = \frac{2 - s}{3}
$$

具体积分示例

示例1： $\displaystyle \int \frac{x - 1}{x^2 + x + 1} \, dx$

$$
\frac{x - 1}{x^2 + x + 1} = \frac{\frac{1}{2}(2x + 1)}{x^2 + x + 1} - \frac{3}{2} \cdot \frac{1}{x^2 + x + 1}
$$

$$
\int \frac{x - 1}{x^2 + x + 1} \, dx = \frac{1}{2} \int \frac{2x + 1}{x^2 + x + 1} \, dx - \frac{3}{2} \int \frac{1}{x^2 + x + 1} \, dx
$$

$$
= \frac{1}{2} \ln |x^2 + x + 1| - \frac{3}{2} \int \frac{1}{\left( x + \frac{1}{2} \right)^2 + \left( \frac{\sqrt{3}}{2} \right)^2} \, dx
$$

$$
= \frac{1}{2} \ln |x^2 + x + 1| - \frac{3}{2} \cdot \frac{2}{\sqrt{3}} \arctan \left( \frac{2x + 1}{\sqrt{3}} \right) + C
$$

$$
= \frac{1}{2} \ln |x^2 + x + 1| - \sqrt{3} \arctan \left( \frac{2x + 1}{\sqrt{3}} \right) + C
$$

示例2： $\displaystyle \int \frac{dx}{x(x^4 + 2)}$

$$
\frac{1}{x(x^4 + 2)} = \frac{1}{2} \left( \frac{1}{x} - \frac{x^3}{x^4 + 2} \right)
$$

$$
\int \frac{dx}{x(x^4 + 2)} = \frac{1}{2} \int \frac{1}{x} \, dx - \frac{1}{2} \int \frac{x^3}{x^4 + 2} \, dx
$$

$$
= \frac{1}{2} \ln |x| - \frac{1}{8} \ln |x^4 + 2| + C
$$

示例3： $\displaystyle \int \frac{x^5 \, dx}{(x^2 + 2x + 2)^2}$
设：

$$
x^5 = (ax + b)(x^2 + 2x + 2)^2 + (cx + d)(x^2 + 2x + 2) + (ex + f)
$$

通过比较系数确定常数后逐项积分。

示例4： $\displaystyle \int \frac{x}{(x - 1)(x^2 + 1)} \, dx$
设：

$$
\frac{x}{(x - 1)(x^2 + 1)} = \frac{A}{x - 1} + \frac{Bx + C}{x^2 + 1}
$$

$$
x = A(x^2 + 1) + (Bx + C)(x - 1) = (A + B)x^2 + (C - B)x + (A - C)
$$

$$
\begin{cases}
A + B = 0 \\
C - B = 1 \\
A - C = 0
\end{cases}
\quad \Rightarrow \quad
A = \frac{1}{2}, \quad B = -\frac{1}{2}, \quad C = \frac{1}{2}
$$

$$
\int \frac{x}{(x - 1)(x^2 + 1)} \, dx = \frac{1}{2} \int \frac{1}{x - 1} \, dx - \frac{1}{2} \int \frac{x}{x^2 + 1} \, dx + \frac{1}{2} \int \frac{1}{x^2 + 1} \, dx
$$

$$
= \frac{1}{2} \ln |x - 1| - \frac{1}{4} \ln |x^2 + 1| + \frac{1}{2} \arctan x + C
$$

常用积分公式

$$
\int \frac{du}{u^2 + a^2} = \frac{1}{a} \arctan \left( \frac{u}{a} \right) + C
$$


推导：令 $u = a \tan t$，则：

$$
\int \frac{du}{u^2 + a^2} = \int \frac{a \sec^2 t}{a^2 \sec^2 t} \, dt = \frac{1}{a} \int dt = \frac{1}{a} t + C = \frac{1}{a} \arctan \left( \frac{u}{a} \right) + C
$$
