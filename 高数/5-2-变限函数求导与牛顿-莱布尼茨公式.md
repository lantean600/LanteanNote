---
layout: default
title: "5-2-变限函数求导与牛顿-莱布尼茨公式"
mathjax: true
---

## 一、牛顿—莱布尼茨公式

若 $F(x)$ 是连续函数 $f(x)$ 在 $[a,b]$ 上的一个原函数（即 $F'(x)=f(x)$ ），则：

$$
\int_{a}^{b} f(x) \ dx = F(b) - F(a) = F(x) \bigg|_{a}^{b}
$$

微分形式： $dF(x) = f(x) \ dx$。

---

## 二、积分上限函数（变上限积分）

1. 定义

设 $f(x)$ 在 $[a,b]$ 上连续，则对任意 $x \in [a,b]$，定义：

$$
\Phi(x) = \int_{a}^{x} f(t) \ dt
$$

称 $\Phi(x)$ 为积分上限函数（或变上限积分函数）。

2. 性质

定理1：若 $f(x)$ 在 $[a,b]$ 上连续，则 $\Phi(x)$ 在 $[a,b]$ 上可导，则：

$$
\Phi'(x) = f(x)
$$

即积分上限函数的导数等于被积函数在上限处的值。

证明：
由导数定义：

$$
\Phi'(x) = \lim_{\Delta x \to 0} \frac{\Phi(x+\Delta x) - \Phi(x)}{\Delta x}
$$

其中：

$$
\Phi(x+\Delta x) - \Phi(x) = \int_{a}^{x+\Delta x} f(t) \, dt - \int_{a}^{x} f(t) \, dt = \int_{x}^{x+\Delta x} f(t) \, dt
$$

由积分中值定理，存在 $\xi$ 介于 $x$ 与 $x+\Delta x$ 之间，使得：

$$
\int_{x}^{x+\Delta x} f(t) \, dt = f(\xi) \cdot \Delta x
$$

于是：

$$
\Phi'(x) = \lim_{\Delta x \to 0} \frac{f(\xi) \cdot \Delta x}{\Delta x} = \lim_{\Delta x \to 0} f(\xi) = f(x)
$$

定理2：若 $f(x)$ 在 $[a,b]$ 上连续，则 $\Phi(x) = \int_{a}^{x} f(t) \ dt$ 是 $f(x)$ 在 $[a,b]$ 上的一个原函数。

---

## 三、牛顿—莱布尼茨公式的证明（利用积分上限函数）

设 $F(x)$ 是 $f(x)$ 的任意一个原函数，由定理2知 $\Phi(x)$ 也是 $f(x)$ 的一个原函数，故：

$$
\Phi(x) = F(x) + C
$$

令 $x = a$，得：

$$
\Phi(a) = \int_{a}^{a} f(t) \, dt = 0 = F(a) + C \implies C = -F(a)
$$

令 $x = b$，得：

$$
\Phi(b) = \int_{a}^{b} f(t) \, dt = F(b) + C = F(b) - F(a)
$$

即：

$$
\int_{a}^{b} f(x) \, dx = F(b) - F(a)
$$

---

## 四、变限积分求导法则

设 $f(t)$ 连续， $\alpha(x)$, $\beta(x)$ 可导，则：

1. 上限为函数：

$$
   \frac{d}{dx} \int_{a}^{\alpha(x)} f(t) \, dt = f(\alpha(x)) \cdot \alpha'(x)
$$

2. 下限为函数：

$$
   \frac{d}{dx} \int_{\beta(x)}^{a} f(t) \, dt = -f(\beta(x)) \cdot \beta'(x)
$$

3. 上下限均为函数：

$$
   \frac{d}{dx} \int_{\beta(x)}^{\alpha(x)} f(t) \, dt = f(\alpha(x)) \cdot \alpha'(x) - f(\beta(x)) \cdot \beta'(x)
$$
   
---

## 五、例题

例1

求：

$$
\frac{d}{dx} \int_{a}^{x} x f(t) \ dt
$$

解：由于 $x$ 与积分变量 $t$ 无关，可提出积分号外：

$$
\frac{d}{dx} \int_{a}^{x} x f(t) \ dt = \frac{d}{dx} \left[ x \cdot \int_{a}^{x} f(t) \, dt \right]
$$

应用乘积法则：

$$
= \frac{dx}{dx} \cdot \int_{a}^{x} f(t) \ dt + x \cdot \frac{d}{dx} \int_{a}^{x} f(t) \, dt
$$

由定理1：

$$
= \int_{a}^{x} f(t) \ dt + x \cdot f(x)
$$

---

例2

设分段函数：

$$
f(x) = 
\begin{cases} 
x^2, & 0 \leq x < 1 \\ 
x,   & 1 \leq x \leq 2 
\end{cases}
$$

求积分上限函数：

$$
\Phi(x) = \int_{0}^{x} f(t) \ dt, \quad x \in [0,2]
$$

解：

· 当 $x \in [0,1)$ 时：

  $$
  \Phi(x) = \int_{0}^{x} t^2 \ dt = \frac{1}{3} x^3
  $$

· 当 $x \in [1,2]$ 时：
  
  $$
  \Phi(x) = \int_{0}^{1} t^2 \ dt + \int_{1}^{x} t \ dt = \frac{1}{3} + \left( \frac{1}{2} x^2 - \frac{1}{2} \right) = \frac{1}{2} x^2 - \frac{1}{6}
  $$
  
  综上：

  $$
  \Phi(x) =
  \begin{cases}
  \frac{1}{3}x^3, & x \in [0,1) \\
  \frac{1}{2}x^2 - \frac{1}{6}, & x \in [1,2]
  \end{cases}
  $$

与概率分布函数的联系：
若 $f(x)$ 是某个连续型随机变量的概率密度函数（需满足非负性与归一性，此处 $f(x)$ 未归一化，仅为形式示例），则 \Phi(x) 即为其累积分布函数 F(x)。它具有以下性质：

1. 非负性： $\Phi(x) \geq 0$（在定义域内）
2. 单调不减： $\Phi'(x) = f(x) \geq 0$（在连续点处）
3. 右连续性：本例中 $\Phi(x)$ 在 $x=1$ 处连续，且 $\Phi(0)=0，\Phi(2)=\frac{1}{2} \cdot 4 - \frac{1}{6} = \frac{11}{6}$（若为概率分布，则需满足 $\Phi(2)=1$，此处仅为数学示例）。

---

例3

计算：

$$
\int_{0}^{\frac{\pi}{2}} \sqrt{1 - \sin 2x} \, dx
$$

解：利用三角恒等式：

$$
1 - \sin 2x = \sin^2 x + \cos^2 x - 2\sin x \cos x = (\sin x - \cos x)^2
$$

因此：

$$
\sqrt{1 - \sin 2x} = \sqrt{(\sin x - \cos x)^2} = |\sin x - \cos x|
$$

$$
\begin{aligned}
\int_{0}^{\frac{\pi}{2}} \sqrt{1 - \sin 2x} \, dx
&= \int_{0}^{\frac{\pi}{4}} (\cos x - \sin x) \, dx + \int_{\frac{\pi}{4}}^{\frac{\pi}{2}} (\sin x - \cos x) \, dx \\
&= \left[ \sin x + \cos x \right]_{0}^{\frac{\pi}{4}} + \left[ -\cos x - \sin x \right]_{\frac{\pi}{4}}^{\frac{\pi}{2}} \\
&= 2(\sqrt{2} - 1)
\end{aligned}
$$

---

六、补充说明

· 积分上限函数是联系微分与积分的重要桥梁，它表明每一个连续函数都有原函数。
· 变限积分求导时，需注意被积函数中是否含有求导变量，若含有则需先分离变量或换元。
· 分段函数的变限积分需分段计算，并注意在分段点处的连续性（通常结果连续）。
